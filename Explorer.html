<!DOCTYPE html>
<html ng-app="fileBrowserApp">
  <head>
    <base target="_top">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/featherlight/1.5.0/featherlight.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/featherlight/1.5.0/featherlight.min.css">
    
    <style>
      body{
        white-space: nowrap;
      }
      #about{ 
        font-family: Arial;
      }
      .created-by{
        position: fixed;
        right: 20px;
        display: inline-block;
        bottom: 20px;
        font-size: 12px;
        cursor: pointer;
        border-radius: 2px;
      }
      .column{
        display: inline-block;
        width: 230px;
        border-right: 1px solid #505050;
        overflow-y: auto;
        font-size: 12px;
        font-family: Arial;
      }
      .file,.folder{
        margin: 5px 0px;
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow:hidden;
        cursor: pointer;
        padding: 5px 5px;
        border-radius: 2px;
      }
      .file:hover,.folder:hover{
        background: #eeeeee!important; /* Old browsers */
        background: -moz-linear-gradient(left,  #eeeeee 0%, #cccccc 100%)!important; /* FF3.6-15 */
        background: -webkit-linear-gradient(left,  #eeeeee 0%,#cccccc 100%)!important; /* Chrome10-25,Safari5.1-6 */
        background: linear-gradient(to right,  #eeeeee 0%,#cccccc 100%)!important; /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#eeeeee', endColorstr='#cccccc',GradientType=1 )!important; /* IE6-9 */

      }
      ::-webkit-scrollbar {
          width: 5px;
      }
      ::-webkit-scrollbar-track {
          background: #FFF;
          -webkit-box-shadow: inset 1px 1px 2px rgba(0,0,0,0.1);
      }
      ::-webkit-scrollbar-thumb {
          background: #CCC;
          -webkit-box-shadow: inset 1px 1px 2px rgba(0,0,0,0.2);
      }
      ::-webkit-scrollbar-thumb:hover {
          background: #AAA;
      }
      ::-webkit-scrollbar-thumb:active {
          background: #888;
          -webkit-box-shadow: inset 1px 1px 2px rgba(0,0,0,0.3);
      }
      .layer{
        position: fixed;
        background: rgba(0,0,0,0.2);
        left: 0px;
        top:0px;
        width: 100%;
        height:100%;
        text-align: center;
      }
      .loader{
        display: inline-block;
        padding: 20px 20px;
        background: #000;
        color: white;
        margin: auto;
        border-radius: 4px;
        font-family: Arial;
        position: relative;
        top: 48%;
      }
      .hide {
        display:none
      }
    </style>
    <script>
      var fileBrowserApp = angular.module('fileBrowserApp', []);
      fileBrowserApp.controller('mainCtrl', function($scope) {
          $scope.driveData = <?!=JSON.stringify(MY_DRIVE)?>;
          $scope.level = 0;
          $scope.loading = false;
          $scope.explorerHeight = $(window).height()-20;
          $scope.breadcrumb = [$scope.driveData];
          
          $scope.getChildren = function($event,type,id,level){
            if(type==1){
              var clickObj = $event.target;
              $(clickObj).parent().find(".folder").css("background","#ffffff");
              $(clickObj).css("background","#e0e0e0");
              $scope.loading = true;
              google.script.run.withSuccessHandler($scope.afterGetChildren).getChildren(id,level);
            }
          }
          
          $scope.open = function(type,url){
            if(type==0){
              window.open(url);
            }
          }
          
          $scope.afterGetChildren = function(obj){
            $scope.loading = false;
            $scope.breadcrumb.splice(obj.level+1, $scope.breadcrumb.length);
            $scope.breadcrumb.push(obj.data);
            $scope.$apply();
            $("html, body").animate({ scrollLeft: $(document).outerWidth() }, "slow");
          }
          
          $( window ).resize(function() {
            $scope.explorerHeight = $(window).height()-20;
            $scope.$apply();
          });
      });
    </script>
  </head>
  <body ng-controller="mainCtrl">
    <div style="height:{{explorerHeight}}px" class="column" ng-repeat="entry in breadcrumb">
      <div ng-repeat="item in entry" class="{{item.type==0 ? 'file' : 'folder'}}" title="{{'Name: '+item.name+'\nCreated: '+item.created+'\nLast Updated: '+item.updated}}" ng-dblclick="open(item.type,item.url)" ng-click="getChildren($event,item.type,item.id,item.level)">
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAMlJREFUOI2d0zFqQkEYBOBPsfEGBlJKytjbWKYMiIW5SiRgSDyJjYWNJ5CAF4hobRsPIIKIWCzGh+z6fE61uzPMDv/slpzxhA9UxTHEJMH9C2oJrosl2pdEObOu4u/KBZ94uTQpx7VRNPGDAV6LGkwxw06Y01tMNC6QZlQ0QRKVyNkz3hP6L6GNqwZzoba7EzygldBPsc4zOGCfMDjckmCtQCMxg4bQdQx9LPIMftG5NUH2HWyFAebhEZvTppQh6uhJf+cTNvjGCo5Fhx7hZo7d6QAAAABJRU5ErkJggg==
" ng-if="item.type==0"/>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTCtCgrAAAAAZ0lEQVQ4T2OgBlAF4k1AfACK9wCxCxATDWqB+D8a/gzEQUDsgAebATEjEDM0ADG6AcTiNCCmyACQXgYFIMbmRGIwSC/lLhg1YDAYUIEkQCquBGIGMSBeBcSwzEQs3gDE0kBMCWBgAAA8866j3m/ilwAAAABJRU5ErkJggg==
" ng-if="item.type==1"/>&nbsp;
        {{item.name}}
      </div>
    </div>
    
    <div class="layer" ng-show="loading">
      <div class="loader">
        <img src="data:image/gif;base64,R0lGODlhEAAQAPQAAAAAAP///wYGBsbGxnp6evj4+NjY2CgoKFZWVujo6IiIiJiYmBoaGmZmZjg4OLa2tqioqAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAkKAAAAIf4aQ3JlYXRlZCB3aXRoIGFqYXhsb2FkLmluZm8AIf8LTkVUU0NBUEUyLjADAQAAACwAAAAAEAAQAAAFUCAgjmRpnqUwFGwhKoRgqq2YFMaRGjWA8AbZiIBbjQQ8AmmFUJEQhQGJhaKOrCksgEla+KIkYvC6SJKQOISoNSYdeIk1ayA8ExTyeR3F749CACH5BAkKAAAALAAAAAAQABAAAAVoICCKR9KMaCoaxeCoqEAkRX3AwMHWxQIIjJSAZWgUEgzBwCBAEQpMwIDwY1FHgwJCtOW2UDWYIDyqNVVkUbYr6CK+o2eUMKgWrqKhj0FrEM8jQQALPFA3MAc8CQSAMA5ZBjgqDQmHIyEAIfkECQoAAAAsAAAAABAAEAAABWAgII4j85Ao2hRIKgrEUBQJLaSHMe8zgQo6Q8sxS7RIhILhBkgumCTZsXkACBC+0cwF2GoLLoFXREDcDlkAojBICRaFLDCOQtQKjmsQSubtDFU/NXcDBHwkaw1cKQ8MiyEAIfkECQoAAAAsAAAAABAAEAAABVIgII5kaZ6AIJQCMRTFQKiDQx4GrBfGa4uCnAEhQuRgPwCBtwK+kCNFgjh6QlFYgGO7baJ2CxIioSDpwqNggWCGDVVGphly3BkOpXDrKfNm/4AhACH5BAkKAAAALAAAAAAQABAAAAVgICCOZGmeqEAMRTEQwskYbV0Yx7kYSIzQhtgoBxCKBDQCIOcoLBimRiFhSABYU5gIgW01pLUBYkRItAYAqrlhYiwKjiWAcDMWY8QjsCf4DewiBzQ2N1AmKlgvgCiMjSQhACH5BAkKAAAALAAAAAAQABAAAAVfICCOZGmeqEgUxUAIpkA0AMKyxkEiSZEIsJqhYAg+boUFSTAkiBiNHks3sg1ILAfBiS10gyqCg0UaFBCkwy3RYKiIYMAC+RAxiQgYsJdAjw5DN2gILzEEZgVcKYuMJiEAOw==
"/> Loading
      </div>
    </div>
    
    <div class="created-by">
      <img data-featherlight="#about" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAABWVBMVEUAAAD///+qqqq/v7+ZzMwAqv+qqtQAtv62traqv7+wxMSvv7+0w8OpuMauu8myv7+pwsKtucWxvMe0v8mtwcGwusStv8iuvcSzwMeuu8KwvcSyv8WuwMewvMKtvcOwwMWyvMawv8SuvMOvvcSvvMOwvcSxvsSvv8WwvMaxvcOvvsSuvcOvvsSuvcWvvcavv8SvvsauvcSvvsWwvsWxvMOwvsWwvsWwvcSvvsWvvcWwvcSvvsWvvsSwvsSvvcWvvcWwvcQDqPSuvsWwvsSvvcQDqPSvvMOwvsUDqPSwvsWwvsWwvcWwvMSwvsWwvcWuvMWwvsOvvsOuvMWwvsWvvsSuvcOwvMWwvsWuvsSwvcOwvMOuvsWuvMOwvsWwvsWuvcWuvMWwvsMDp/QDqfSuvsOuvMWwvMWuvsSuvsOwvMOvvMWuvsWwvsOwvMOwvsWwvsOuvMMDqfSwvsWJ65rsAAAAcXRSTlMAAQMEBQYGBwcMDRAREhMUFRYXGBkaHCMlJicoKSovMTI0SUpNTk9QUVJTVldZWmRnaWprbG5vcXN0dXd6foCBjI6Oj5CRkZKUtrm/wMLDyMnKy8zNzs/Q0dLT1Nvc3d7r7e/x8fLz9PX29/j5+vz9/ruqE9kAAAJwSURBVEjHlZbXX1pBEIXHgMRoEIwYNWrUiL0RrEGNBRGxKyioYBdQQNjv/3/Ig4nhNsB5ur8z52yZszt3RfThmQrvpG4LhdvUztZkq1QJ13wUTZzMNVegfw0/YYjsZpsF3bGcBcjvrgx1OR0OZ/fQyl4eILNkN+N/SwCc+prKwc++M4B4p5E/lgbiP4yJgXMgPaKH/UV4XvhgNrXtVw6KPi34E0h+typGbwrQKMaKcOyyLp87CsXhsv2m4fhTGeHj9v19qL4MaIzCY8dbPROQ1Iy/rZRSIc0cV3D2r7rL8Kxd/71SSt1poL4cBP76m4UFqSaQAGQ8IiIShriuniGllFrXVfcCNkREXE+g96s+dHe3Xq8DvZBtFpF5OJWaIg6zIhLVeWIdfjgS8UC+qTaBs0CpRaZg15AyGPca+zAhYVgxZIzGiYjIbwjKDgwZMmY+iMgIRCQFXYaMUkopZYB7ICm34KxV4IIbKYCjVkED5N8vePeSUtD9rk2bltVCMAoR2TIzzkKwCkGZhL1aBQcwLq1mh89c4CxQcoucmBxvc4EfDkVkDs5qEtQlYEZEmrMwUIvACxmniMgmnNuqC+yXsCYiIm0ZWKwuWIJ069tnrrfafejP/x/WHoeUu3JfarmG2NvCO9Nw0lipLzXG4KG97O4VIeq27hdfYvAyWI74gKs+K37/NTCtxXxFyAVsZnT7Uh5epvXw8CNw4TXQ67yXwMOgcaCO1x+sX3P/nP4EQKzddOpABqCw/3ukx9XQ4OoZXT0oAKQXbRab82xkjU+HzFqlF0rz7FGpnF06nHFW69EtE8FI8iafv0lGguNGb/4A28n+GdJ2PhwAAAAASUVORK5CYII="/>
    </div>
    <div id="about" class="hide">
	<h3 style="text-align:center">Column File Browser</h3>
	<table cellpadding="20">
		<tr>
			<td style="vertical-align:top;">     
                Created by
				<br/>
				<a href="http://funbutlearn.com" target="_blank" style="text-decoration:none;color:#3D81EF">Fun But Learn
					<br/>
				</td>
				<td style="border-left: 1px solid #c0c0c0">
                    A blog of
					<br/>
					<a style="text-decoration:none" href="http://tabgraf.com" target="_blank">
						<img style="width: 150px;position:relative;top:8px" src="http://tabgraf.com/wp/wp-content/uploads/2016/02/Drawing-4.png"/>
					</a>.com
      
					<br/>
					<br/>For any Apps Script automation and help drop a mail at
					<a style="text-decoration:none;color:#3D81EF" href="mailto:support@tabgraf.com">support@tabgraf.com</a>
				</td>
			</tr>
		</table>
	</div>
  </body>
</html>


